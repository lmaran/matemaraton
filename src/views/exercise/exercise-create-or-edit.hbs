<style>
    .hide-statement-editor {
        display: none;
    }

    .hide-solution-editor {
        display: none;
    }

    .hide-hint-editor {
        display: none;
    }
</style>

<nav aria-label="breadcrumb">
    <ol class="breadcrumb">
        {{!-- <li class="breadcrumb-item"><a href="/"><i class="fas fa-home"></i></a></li> --}}
        <li class="breadcrumb-item"><a href="/">Acasă</a></li>
        <li class="breadcrumb-item"><a href="/exercitii">Exerciții</a></li>
        <li class="breadcrumb-item active" aria-current="page">
            {{#if isEditMode}} Edit: E.{{exercise.code}}{{else}}Adaugă{{/if}}
        </li>
    </ol>
</nav>

<h1 id="exercise-id-container" data-exercise-id="{{exercise._id}}">
    {{#if isEditMode}} Edit: Exercițiul {{exercise.code}}{{else}} Exercițiu nou:{{/if}}
</h1>



{{!-- <div>{{id}}</div> --}}


<form method="post" action="/exercitii/createoredit" novalidate onsubmit="saveBtn.disabled = true; return true;">

    {{!-- statement --}}
    <div class="form-group">
        <label for="statement-editor-txt" class="col-md-3s col-form-label required"> Enunț:
            (<a href="https://markdown-it.github.io/" target="_blank">markdon</a>
            <small><i class="fas fa-external-link-alt text-muted text-small" aria-hidden="true"></i></small>
            +
            <a href="https://katex.org/docs/supported.html" target="_blank">latex </a>
            <small><i class="fas fa-external-link-alt text-muted text-small" aria-hidden="true"></i></small>)</label>

        <div id="statement-editor-div" class="col-md-7s {{#if isEditMode}}hide-statement-editor{{/if}}">
            <textarea id="statement-editor-txt" rows="8" name="statement"
                style="border-radius:0; border-bottom-width:0; border-color:#bb815d"
                class="form-control {{#if errors.lastName}}is-invalid {{/if}}"
                value="{{data.lastName.val}}">{{{exercise.question.statement.text}}}</textarea>
            <div class="invalid-feedback">{{errors.statement.msg}}</div>
        </div>

        <div class="col-md-7s">
            <div id="statement-preview-div"
                style="border: 1px solid #bb815d; padding: 6px 12px; background-color: #fff9f8; min-height:58px">
                {{{exercise.question.statement.textPreview}}}
            </div>
            {{#if isEditMode}}
            <div class="text-right text-muted">
                <button id="toggle-statement-editor-btn" type="button" class="btn btn-link p-0 mt-n1">Editează</button>
            </div>
            <div class="invalid-feedback">{{errors.statement.msg}}</div>
            {{/if}}
        </div>
    </div>


    {{!-- solution --}}
    <div class="form-group">
        <label for="solution-editor-txt" class="col-md-3s col-form-label required"> Soluție: </label>

        <div id="solution-editor-div" class="col-md-7s {{#if isEditMode}}hide-solution-editor{{/if}}">
            <textarea id="solution-editor-txt" rows="8" name="solution"
                style="border-radius:0; border-bottom-width:0; border-color:#008000"
                class="form-control {{#if errors.solution}}is-invalid {{/if}}"
                value="{{data.solution.val}}">{{{exercise.question.solution.text}}}</textarea>
            <div class="invalid-feedback">{{errors.solution.msg}}</div>
        </div>

        <div class="col-md-7s">
            <div id="solution-preview-div"
                style="border: 1px solid #008000; padding: 6px 12px; background-color: #f5fff5; min-height:58px">
                {{{exercise.question.solution.textPreview}}}
            </div>
            {{#if isEditMode}}
            <div class="text-right text-muted">
                <button id="toggle-solution-editor-btn" type="button" class="btn btn-link p-0 mt-n1">Editează</button>
            </div>
            <div class="invalid-feedback">{{errors.solution.msg}}</div>
            {{/if}}
        </div>
    </div>


    {{!-- hints --}}
    <div class="form-group">
        {{!-- <label class="col-md-3s col-form-label"> Indicații: </label> --}}
        {{#each exercise.question.hints}}
        {{!-- <div>Indicația 1:</div> --}}
        <div class="hint-parent-div">
            <label class="col-form-label"> Indicația 1: </label>

            <div class="hint-editor-div col-md-7s {{#if @root.isEditMode}}hide-hint-editor{{/if}}">
                <textarea rows="2" name="hints" style="border-radius:0; border-bottom-width:0; border-color:#007bff"
                    class="hint-txt form-control {{#if errors.solution}}is-invalid {{/if}}"
                    value="{{data.solution.val}}">{{{text}}}</textarea>
            </div>

            <div class="col-md-7s mb-3">
                <div class="hint-preview-div"
                    style="border: 1px solid #007bff; padding: 6px 12px; background-color: #f5faff; min-height:58px">
                    {{{textPreview}}}</div>

                {{#if @root.isEditMode}}
                <div class="text-right text-muted">
                    <button type="button" class="toggle-hint-editor-btn btn btn-link p-0 mt-n1">Editează</button>
                </div>
                <div class="invalid-feedback">{{errors.solution.msg}}</div>
                {{/if}}
            </div>

        </div>
        {{/each}}
    </div>


    {{!-- {{#if isEditMode}}
    <div class="form-group row2">
        <div class="col-md-7s offset-md-3s">
            <button class="btn btn-primary" id="save-btn">Salvează</button> <i id="save-statement-status-icon"
                class="fa fa-check mr-2 fa-lg hide" style="color:green;"></i>
        </div>
    </div>
    {{/if}} --}}

    <div class="form-row">
        <div class="form-group col-md-6">
            <label for="gradeSelect">Clasa:</label>
            <select name="grade" class="form-control" id="gradeSelect">
                {{#select exercise.grade}}
                <option value=""></option>
                {{#each gradeAvailableOptions}}
                <option value="{{value}}">{{text}}</option>
                {{/each}}

                {{/select}}
            </select>
        </div>

        <div class="form-group col-md-6">
            <label for="branchSelect">Ramura:</label>
            <select name="branch" class="form-control" id="branchSelect">
                {{#select exercise.branch}}
                <option value=""></option>
                {{#each branchAvailableOptions}}
                <option value="{{value}}">{{text}}</option>
                {{/each}}

                {{/select}}
            </select>
        </div>
    </div>

    <div class="form-row">
        <div class="form-group col-md-6">
            <label for="contestTypeSelect">Tipul concursului
                <span class="text-muted">(la care a fost dat accest ex.)</span>:</label>
            <select name="contestType" class="form-control" id="contestTypeSelect">
                {{#select exercise.contestType}}
                <option value=""></option>
                {{#each contestTypeAvailableOptions}}
                <option value="{{value}}">{{text}}</option>
                {{/each}}
                {{/select}}
            </select>
        </div>

        <div class="form-group col-md-6">
            <label for="contestNameInput">Numele concursului:</label>
            <input type="text" name="contestName" class="form-control" id="contestNameInput" placeholder=""
                value="{{exercise.contestName}}">
        </div>
    </div>

    <div class="form-row">
        <div class="form-group col-md-6">
            <label for="sourceTypeSelect">Tipul sursei
                <span class="text-muted">(de unde a fost copiat ex.)</span>:</label>
            <select name="sourceType" class="form-control" id="sourceTypeSelect">
                {{#select exercise.sourceType}}
                <option value=""></option>
                {{#each sourceTypeAvailableOptions}}
                <option value="{{value}}">{{text}}</option>
                {{/each}}
                {{/select}}
            </select>
        </div>

        <div class="form-group col-md-6">
            <label for="sourceNameInput">Numele sursei:</label>
            <input type="text" name="sourceName" class="form-control" id="sourceNameInput" placeholder=""
                value="{{exercise.sourceName}}">
        </div>
    </div>

    <div class="form-row">
        <div class="form-group col-md-6">
            <label for="chapterSelect">Capitol:
                {{!-- <span class="text-muted">(de unde a fost copiat ex.)</span>:--}}</label>
            <select name="chapter" class="form-control" id="chapterSelect">
                {{#select exercise.chapter}}
                <option value=""></option>
                {{#each chapterAvailableOptions}}
                <option value="{{value}}">{{text}}</option>
                {{/each}}
                {{/select}}
            </select>
        </div>

        <div class="form-group col-md-6">
            <label for="authorInput">Autor:</label>
            <input type="text" name="author" class="form-control" id="authorInput" placeholder=""
                value="{{exercise.author}}">
        </div>
    </div>

    <div class="form-row">
        <div class="form-group col-md-6">
            <label for="tagsInput">Etichete:</label>
            <input type="text" name="tags" class="form-control" id="tagsInput" placeholder="" value="{{exercise.tags}}">
        </div>

        <div class="form-group col-md-6">
            <label for="obsInput">Observații:</label>
            <input type="text" name="obs" class="form-control" id="obsInput" placeholder="" value="{{exercise.obs}}">
        </div>
    </div>

    <input type="hidden" name="code" value="{{exercise.code}}" />

    <div class="form-group row2">
        <div class="col-md-7s offset-md-3s">
            <button type="submit" name="saveBtn" class="btn btn-primary"><i class="fas fa-save"></i>
                Salveaza</button>
            {{!-- <button type="button" class="btn btn-light" onclick='window.history.back();'>
                <i class="fas fa-times"></i>
                Renunta</button> --}}
            <a href="/exercitii" class="btn btn-light"><i class="fa fa-times"></i> Renunță</a>
            {{#if isEditMode}}
            <button type="submit" formaction="/exercitii/delete" name="deleteBtn" class="btn btn-link"
                onclick="return confirm('Ești sigur că vrei să ștergi acest exercițiu?');"><i
                    class="fas fa-trash-alt"></i>
                Șterge</button>
            {{/if}}
        </div>
    </div>

</form>



{{!-- Enunț:
<textarea id="statement-editor-txt" rows="15" cols="150">{{{exercise.question.statement.text}}}</textarea>

<button id="save-btn">Salvează</button> <i id="save-statement-status-icon" class="fa fa-check mr-2 fa-lg hide"
    style="color:green;"></i>

<div id="katex-preview-div" style2="font-family: KaTeX_Main; font-size: 1.1em;">
    {{{exercise.question.statement.textPreview}}}</div> --}}


{{#section 'script'}}
<script type="module" src="/js/exercise/main.js"></script>
{{/section}}