<style>
    .hidePresence {
        display: none;
    }

    .hideStudent {
        display: none;
    }
</style>

<nav aria-label="breadcrumb">
    <ol class="breadcrumb">
        <li class="breadcrumb-item"><a href="/">Acasa</i></a></li>
        <li class="breadcrumb-item" aria-current="page"><a href="/clase/{{class._id}}">Clasa:
                {{class.grade}}-{{class.name}}</a></li>
        <li class="breadcrumb-item active" aria-current="page">Prezenta</li>
    </ol>
</nav>

<h1>Prezenta</h1>
<h2 class="mb-5">Clasa a {{class.grade}}-a, {{class.name}}</h2>

{{#unless studentsInClass.length}}
<p>Nu exista date.</p>
{{/unless}}

{{#each courses}}
<div {{#if (gt @index 2)}} class="toggle-presence hidePresence" {{/if}}>

    <h3 {{#if noCourse}} class="text-muted" {{/if}}>{{dateAsString}} {{#if course}}- <a href="/cursuri/{{_id}}">curs
            {{course}}</a> {{/if}}</h3>

    {{#if noCourse}}
    <p style="padding-left:40px;" class="text-muted">Nu s-a tinut curs ({{noCourseReason}})</p>
    {{/if}}

    <ul>
        {{#each students}}
        <li><a href="/elevi/{{_id}}/prezenta">{{shortName}}</a>
            {{#if gradeAndLetter}}
            ({{gradeAndLetter}})
            {{/if}}
            {{#if (eq @../index 0)}}
            - prezente: {{totalPresences}} din {{../../totalActiveCourses}}
            {{/if}}
        </li>
        {{/each}}
    </ul>
</div>
{{/each}}
{{#if (gt totalActiveCourses 3)}}
<a class="toggle-presence" href="#" style="font-size:1.2rem; vertical-align: bottom;">Vezi toate prezentele <i
        class="fas fa-angle-double-right"></i></a>
<a class="toggle-presence hidePresence" href="#" style="font-size:1.2rem; vertical-align: bottom;"><i
        class="fas fa-angle-double-left"></i> Vezi doar primele prezente </a>
{{/if}}

{{#if studentsInClass.length}}
<h3 class="mt-5">Cumulat pe elevi: </h3>
{{/if}}

{{#each studentsInClass}}
<div {{#if (gt @index 7)}} class="toggle-student hideStudent" {{/if}}>
    <a href="/elevi/{{_id}}/prezenta">{{shortName}}</a>
    {{#if gradeAndLetter}} ({{gradeAndLetter}}){{/if}} - prezente: {{totalPresences}} din
    {{../totalActiveCourses}} ({{totalPresencesAsPercent}}%)
    <div class="progress mb-2">
        <div class="progress-bar" role="progressbar" style="width: {{totalPresencesAsPercent}}%" aria-valuenow="25"
            aria-valuemin="0" aria-valuemax="100"></div>
    </div>
</div>
{{/each}}

{{#if (gt studentsInClass.length 8)}}
<div class="mb-5">
    <a class="toggle-student" href="#" style="font-size:1.2rem">Vezi toti elevii <i
            class="fas fa-angle-double-right"></i></a>
    <a class="toggle-student hideStudent" href="#" style="font-size:1.2rem; vertical-align: bottom;"><i
            class="fas fa-angle-double-left"></i> Vezi doar primii elevi </a>
</div>
{{/if}}


{{#section 'script-after'}}
<script>
    (function () {
        // DOM ready
        $(function () {
            // elements
            var togglePresencesElem = $("a.toggle-presence");
            var toggleStudentsElem = $("a.toggle-student");

            // events
            togglePresencesElem.click(togglePresences);
            toggleStudentsElem.click(toggleStudents);
        });

        var togglePresences = function () {
            event.preventDefault();
            $(".toggle-presence").toggleClass("hidePresence");
        }

        var toggleStudents = function () {
            event.preventDefault();
            $(".toggle-student").toggleClass("hideStudent");
        }

    }())
</script>
{{/section}}